[gcode_shell_command punput]
##Update the below command: with the path to your user folder and select chosen API
command: python /home/pi/printer_data/config/punput_shaping/punput_shaper.py icanhazdadjoke
#command: python /home/pi/printer_data/config/punput_shaping/punput_shaper.py	official
#command: python /home/pi/printer_data/config/punput_shaping/punput_shaper.py	norris
#command: python /home/pi/printer_data/config/punput_shaping/punput_shaper.py	jokeapi
#command: python /home/pi/printer_data/config/punput_shaping/punput_shaper.py	local
timeout: 5

[gcode_macro PunputShaping]
variable_punputshaping_loop_duration: 900													#15 minutes default
gcode:
    RUN_SHELL_COMMAND CMD=punput

#UPDATE_DELAYED_GCODE ID=PunputShaping_Loop DURATION={printer["gcode_macro PunputShaping"].punputshaping_loop_duration}
#UPDATE_DELAYED_GCODE ID=PunputShaping_Loop DURATION=0										#Execute to cancel
[delayed_gcode PunputShaping_Loop]
gcode:
  {% if printer.idle_timeout.state == "Printing" %}
    PunputShaping
	UPDATE_DELAYED_GCODE ID=PunputShaping_Loop DURATION={printer["gcode_macro PunputShaping"].punputshaping_loop_duration}
  {% endif %}